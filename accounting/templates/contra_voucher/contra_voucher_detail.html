{% extends 'dashboard/index.html' %}

{% block dashoard_title %} 
Contra Voucher List - 
{% endblock %}

{% block dashboard_heading %}
<h1 class="h5 mb-0 text-gray-800">
  Contra Voucher List
</h1>

<a href="{% url 'accounting:create_contra_voucher' module=module %}" class="d-inline-block btn  btn-primary shadow-sm"><i
    class="fas fa-plus text-white-50"></i> Create Contra Voucher</a>


{% endblock %}


{% block dashboard_content %}
<div class="">

  <form action="" method="post">
      {% csrf_token %}
      <div class="row">
        <div class="col-2">
          <label for="choose_company">Choose Branch</label>
          <select name="choose_company" class="form-control form-control-sm" id="choose_company" >
              {% if choose_company == 'All' %}
              <option value="All" selected>All</option>
              {% else %}
              <option value="All">All</option>
              {% endif %}
              {% for data in global_companies %}
              {% if choose_company == data.id %}
              <option value="{{data.id}}" selected>{{data.company_name}}</option>
              {% else %}
              <option value="{{data.id}}">{{data.company_name}}</option>
              {% endif %}
              {% endfor %}
          </select>
        </div>
        
          <div class="col-2">
              <label for="from_date">From Date</label>
              <input type="date" name="from_date" value="{{from_date|date:'Y-m-d'}}" class="form-control form-control-sm" id="start_date">
          </div>
          <div class="col-2">
              <label for="to_date">To Date</label>
              <input type="date" name="to_date" value="{{to_date|date:'Y-m-d'}}" class="form-control form-control-sm" id="to_date">
          </div>
          <div class="col-2">
              <button type="submit" class="btn btn-primary btn-sm mt-4">Filter</button>
          </div>
      </div>
  </form>

</div>
<div class="table-responsive">

<table class="table table-primary compact display table-bordered table-md-responsive" id="contra_voucher_table">
  <thead>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Voucher No.</th>
      <th scope="col">Instrument No.</th>
      <th scope="col">Contra Choice</th>
     
      <th scope="col">From Bank</th>
      <th scope="col">To Bank</th>
      <th scope="col">Cash A/C</th>
    
      <th scope="col">Amount</th>
     



      <th scope="col">Actions</th>

    </tr>
  </thead>
  <tbody>
    {% for data in vouchers %}
    <tr>
      
      <td>{{ data.voucher_date|date:"Y-m-d" }}</td>
      <td>{{ data.voucher_no }}</td>
      <td>{{ data.instrument_no }}</td>
      <td>{{ data.contra_choice }}</td>
      {% if data.account_from %}
      <td>{{ data.account_from }}</td>
      {% else %}
      <td>-</td>
      {% endif %}
      {% if data.account_to %}
      <td>{{ data.account_to }}</td>
      {% else %}
      <td>-</td>
      {% endif %}

     
     
      {% if data.cash %}
      <td>{{ data.cash }}</td>
      {% else %}
      <td>-</td>
      {% endif %}

      <td align="right">{{ data.amount|floatformat:2 }}</td>


      <td>
        <a href="{% url 'accounting:contra_voucher_update' module=module id=data.id %}" class="btn btn-xs btn-info"><i
            class="fas fa-edit"></i></a>

            {% if request.user.user_account.can_delete %}
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-xs btn-danger" data-toggle="modal"
          data-target="#deleteModal{{ forloop.counter }}">
          <i class="fas fa-trash"></i>
        </button>

        <!-- Modal -->
        <div class="modal fade" id="deleteModal{{ forloop.counter }}" tabindex="-1" role="dialog"
          aria-labelledby="deleteModal{{ forloop.counter }}Label" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="deleteModal{{ forloop.counter }}Label">Delete {{data.voucher_no}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                Are you sure want to delete {{ data.voucher_no }}?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a href="{% url 'accounting:contra_voucher_delete' module=module id=data.id %}"
                  class="btn btn-primary">Confirm Delete</a>
              </div>
            </div>
          </div>
        </div>
        {% endif %}

      </td>

    </tr>

    {% endfor %}

  </tbody>
</table>

  
</div>


{% endblock %}


{% block js %}

<script>
    let table = new DataTable('#contra_voucher_table', {
        // options
        dom: 'BQlfrtip',
        "pageLength": 50,
        buttons: [
        {
            extend: 'collection',
            text: 'Export',
            buttons: [
                'copy',
                'excel',
                'csv',
                'pdf',
               
            ]
        },

        ]

    });
  
    document.querySelector('.dtsb-title').style.display = 'none'

</script>

{% endblock %}