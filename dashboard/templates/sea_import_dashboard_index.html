{% extends 'dashboard/index.html' %}
{% block dashoard_title %} Sea Import | {% endblock %}
{% block dashboard_heading %}
<style>
  a {
    text-decoration: none !important;
  }

  .blue {
    background-color: #065568;
  }

  .green {
    background-color: #036b28;
  }

  .orange {
    background-color: #ef7700;
  }

  .red {
    background-color: #b00707;
  }

  .card {
    transition: all 0.2s ease-in-out;
    cursor: pointer;
  }

  .link {
    padding-top: 5px;
    padding-bottom: 5px;
    transition: all 0.2s ease-in-out;
    cursor: pointer;
  }

  .link:hover {
    transform: scale(1.01);
    background-color: #aeb7b18f;
    border-radius: 10px;
  }

  .card h6 {
    font-size: 14px;
  }
</style>

<h1 class="h3 mb-0 text-gray-800">
  <span class="greeting-text">{{greeting}}</span>, {{ request.user.first_name }}
  {{ request.user.last_name }}
</h1>
{% if request.user.user_account.can_report %}
<div class="dropdown">
  <a class="btn btn-primary dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
    Reports
  </a>

  <div class="dropdown-menu">
    <a class="dropdown-item" href="{% url 'acr:job_cost_sheet_detail' module=module %}">Job Cost Sheet</a>

  </div>
</div>
{% endif %}
{% endblock %}
{% block dashboard_content %}

<div><span class="badge badge-primary"> <i class="fas fa-ship"></i> Sea Import Dashboard</span></div>

{% if global_companies|length > 1 %}
<form action="{% url 'dashboard:sea_import_dashboard' module=module %}" method="post">
  {% csrf_token %}
  <div class="row mb-1">
    <div class="col-md-2">
      <label for="company">Company</label>
      <select name="company" class="form-control form-control-sm" id="company">
        {% if selected_company == 'all' %}
        <option value="all" selected>All</option>
        {% else %}
        <option value="all">All</option>
        {% endif %}
        {% for i in global_companies %}
        {% if i.id == selected_company %}
        <option value="{{i.id}}" selected>{{i}} ({{i.branch_name}})</option>
        {% else %}
        <option value="{{i.id}}">{{i}} ({{i.branch_name}})</option>
        {% endif %}
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3 mt-1">
      <button type="submit" class="mt-4 btn btn-sm btn-primary">Search</button>
    </div>
  </div>
</form>
{% endif %}

<div class="row mb-1">

  <!-- Left Side of the Dashboard -->
  <div class="col-md-8">


    <div class="row">
      <div class="col-md-6 col-sm-12 mb-1">
        <div class="card green">
          <div class="card-body">
            <h6 class="card-title text-white">
              <i class="bi bi-receipt"></i> Total Jobs
            </h6>
            <div class="row">
              <div class="col-4 link">
                <a href="{% url 'operations:job_details' module=module %}" style="text-decoration: none">
                  <h6 class="text-white">Active</h6>
                  <h6 class="text-white">{{active_jobs}}</h6>
                </a>
              </div>
              <div class="col-4 link">
                <a href="{% url 'operations:closed_jobs' module=module %}" style="text-decoration: none">
                  <h6 class="text-white">Closed</h6>
                  <h6 class="text-white">{{closed_jobs}}</h6>
                </a>
              </div>
              <div class="col-4 link">
                <a href="{% url 'operations:cancelled_jobs' module=module %}" style="text-decoration: none">
                  <h6 class="text-white">Cancelled</h6>
                  <h6 class="text-white">{{cancel_jobs}}</h6>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-7">
        <hr>
        <h6 class="badge badge-primary">Coming Shipments within 5 Days</h6>

        <table class="table table-bordered table-sm table-primary">
          <thead>
            <tr>
              <th scope="col" class="py-3 text-center">Job No</th>
              <th scope="col" class="py-3 text-center">Job Date</th>
              <th scope="col" class="py-3 text-center">ETA</th>
              <th scope="col" class="py-3 text-center">Customer</th>
              <th scope="col" class="py-3 text-center">Status</th>
            </tr>
          </thead>
          <tbody>
            {% for job in coming_eta_jobs %}
            <tr>
              <td><a href="{% url 'operations:job_update' module=module id=job.id %}">{{job.job_no}}</a></td>
              <td>{{job.job_date}}</td>
              <td>{{job.eta_date}}</td>
              <td>{{job.account.party_name}}</td>
              <td>{{job.job_status}}</td>
            </tr>
            {% empty %}
              <tr>
                <td colspan="5" style="text-align:center; padding:15px; color:#555; font-style:italic;">
                  No jobs scheduled with an ETA within the next 5 days.
                </td>
              </tr>
              {% endfor %}

          </tbody>
        </table>
      </div>
    </div>


  </div>



  <!-- Right Side of the Dashboard -->
  <div class="col-md-4">
    {% include "components/dashboard_alerts.html" %}
  </div>


</div>







{% endblock %}