{% load humanize %}
{% load mathfilters %}
{% load custom_tags %}


{% if not data.depth > 0 %}
<tr>
  <td colspan="2">
    <strong> {{data.category.name}} </strong>
  </td>
  <td align="right">{{data.total|floatformat:2|intcomma}}</td>
</tr>

{% else %}
<tr>
  <td style="font-size: 12px; margin-left: {{data.depth|add:20}}px;">
    {% if data.category and not data.total == 0 %}
    <a target="_blank" href="{% url 'acr:ledger_category_transactions' module=module company=company.id from_date=from_date to_date=to_date id=data.category.id %}">  <i>{{data.category.name}}</i></a>
    {% else %}
    <i>{{data.category.name}}</i>
    {% endif %}  
  
  
  
  </td>
  {% if forloop.last or data.ledger_report %}
  <td align="right" style="border-bottom: 2px solid black; font-size: 12px; margin-left: {{data.depth|add:20}}px;">
    {{data.total|floatformat:2|intcomma}}
  </td>
  {% else %}
  <td style="font-size: 12px; margin-left: {{data.depth|add:20}}px;" align="right">  
    {{data.total|floatformat:2|intcomma}}
  </td>
  {% endif %}
  <td>&nbsp;</td>
</tr>
{% endif %}

{% for ledger in data.ledger_report %}
<tr>
    <td style="font-size: 11px; font-weight: 400;">
        <span style="margin-left: {{data.depth|add:23}}px;"></span>
        {% if ledger.id and ledger.type %}
        <a target="_blank" href="{% url 'acr:ledger_category_transactions' module=module company=company from_date=from_date to_date=to_date id=data.category.id detail_id=ledger.id detail=1 type=ledger.type %}">  
              <i> {{ledger.particulars}} </i>
            </a>
            {% else %}
              <i> {{ledger.particulars}} </i>
            {% endif %}
        
    </td>
    <td data-order="0" style="font-size: 11px; font-weight: 400; text-align: right;">
        {% if ledger.debit|sub:ledger.credit >= 0 %} 
        {{ledger.debit|sub:ledger.credit|floatformat:2}} Dr.   
        {% else %}
        {{ledger.debit|sub:ledger.credit|mul:-1|floatformat:2}} Cr.   
        {% endif %}
    </td>
    <td data-order="0">&nbsp;</td>

</tr>
{% endfor %}

{% for data in data.report %}
    {% include 'report/balance_sheet_report_category/list.html' %}
{% endfor %}
